options:
  logging: CLOUD_LOGGING_ONLY

steps:
  - name: 'gcr.io/cloud-builders/docker'
    args: ['build', '-t', 'us-central1-docker.pkg.dev/western-notch-453423-p9/csci5409/container2:latest', '.']

  - name: 'gcr.io/cloud-builders/docker'
    args: ['push', 'us-central1-docker.pkg.dev/western-notch-453423-p9/csci5409/container2:latest']

  - name: "gcr.io/cloud-builders/gke-deploy"
    args:
    - run
    - --filename=./kubernetes
    - --image=us-central1-docker.pkg.dev/western-notch-453423-p9/csci5409/container2:latest
    - --location=us-central1
    - --cluster=assignment-cluster
    
  # - name: 'gcr.io/cloud-builders/kubectl'
  #   args:
  #     - 'set'
  #     - 'image'
  #     - 'deployment/container2-deployment'
  #     - 'container2=us-central1-docker.pkg.dev/western-notch-453423-p9/csci5409/container2:latest'
  #   env:
  #     - 'CLOUDSDK_COMPUTE_REGION=us-central1'
  #     - 'CLOUDSDK_COMPUTE_ZONE=us-central1'
  #     - 'CLOUDSDK_CONTAINER_CLUSTER=assignment-cluster'

  # - name: 'gcr.io/cloud-builders/kubectl'
  #   args:
  #     - 'rollout'
  #     - 'restart'
  #     - 'deployment/container2-deployment'
  #   env:
  #     - 'CLOUDSDK_COMPUTE_REGION=us-central1'
  #     - 'CLOUDSDK_COMPUTE_ZONE=us-central1'
  #     - 'CLOUDSDK_CONTAINER_CLUSTER=assignment-cluster'